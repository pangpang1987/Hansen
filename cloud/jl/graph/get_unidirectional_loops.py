#-*- coding:utf-8 -*-
#指定中文编码

###########################################################################################################################
#
#	igraph 模块
#
###########################################################################################################################

# from .create_igraph     import  create_igraph

#€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€
#
#   单向回路
#
def get_unidirectional_loops(dGraph) :
        """查找含有单向回路的强联通块
        :返回含有单向回路的强联通块
        :所有单向回路联通块在一起，对结果需要根据要求二次处理
        """

        cl = dGraph.components(mode='strong')
        comps = []
        for g in cl.subgraphs():
            # 至少2条边才能构成单向回路
            if len(g.es) < 2:continue
            # 子图的index与原图已经不一致了!
            # 这里只能使用id属性进行返回!
            comps.append([e["id"] for e in g.es])
        # 释放内存
        del cl
        return comps

"""
    在 igraph 中，components(mode='strong') 用于分析有向图的强连通分量（Strongly Connected Components, SCC）。
    这是图论中的一个核心概念，用于确定图中哪些部分是 “相互可达” 的。
    什么是强连通分量？
    在有向图中：
    强连通：如果两个顶点 u 和 v 之间存在双向路径（即从 u 到 v 和从 v 到 u 都有路径），则称它们强连通。
    强连通分量（SCC）：图中的一个最大子图，其中任意两个顶点之间都是强连通的。
    直观地说，SCC 是图中的 “紧密社区”，内部顶点可以互相到达，但与外部顶点可能只有单向连接或无连接。
    components(mode='strong') 函数详解
    Graph.components(mode='strong')
    参数：
    mode：指定连通性类型，可选值：
    'strong'（默认）：计算强连通分量。
    'weak'：计算弱连通分量（将有向边视为无向边）。
    返回值：
    一个 VertexClustering 对象，包含以下属性：
    membership：每个顶点所属的 SCC 编号（从 0 开始）。
    sizes：每个 SCC 的大小（顶点数量）。
    count：SCC 的总数。
    示例代码
    # 创建一个有向图（示例图）
    g = Graph(directed=True)
    g.add_vertices(6)  # 添加6个顶点
    g.add_edges([
        (0, 1), (1, 2), (2, 0),  # 形成一个环（SCC 1）
        (3, 4), (4, 5), (5, 3)   # 形成另一个环（SCC 2）
    ])  # 两个 SCC 之间没有连接
    # 计算强连通分量
    scc = g.components(mode='strong')
    print(f"SCC 数量: {scc.count}")
    print(f"各 SCC 大小: {scc.sizes}")
    print(f"顶点所属 SCC: {scc.membership}")
    # 输出：
    # SCC 数量: 2
    # 各 SCC 大小: [3, 3]
    # 顶点所属 SCC: [0, 0, 0, 1, 1, 1]
    弱连通分量 vs 强连通分量
    属性	        强连通分量（Strong）	                    弱连通分量（Weak）
    路径方向	     必须存在双向路径	                        忽略边的方向，只需存在无向路径
    应用场景	    分析相互依赖关系（如网络路由、社交网络影响力）	    分析整体连接结构（如通信网络是否断开）
    计算复杂度	    较高（Kosaraju 或 Tarjan 算法）	            较低（基于 BFS/DFS）
    示例图的结果	可能有多个 SCC	                            通常只有一个弱连通分量（如果图是连通的）
    注意事项
    每个顶点恰好属于一个强连通分量。
    单个顶点如果没有双向路径，自身就是一个 SCC。
    若整个图是强连通的，则 scc.count == 1。
    """
#€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€€

